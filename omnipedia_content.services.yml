services:

  # The OmnipediaElement plug-in manager.
  plugin.manager.omnipedia_element:
    class: Drupal\omnipedia_content\OmnipediaElementManager
    parent: default_plugin_manager
    calls:
      -
        - setAddtionalDependencies
        -
          - '@messenger'
          - '@renderer'
          - '@string_translation'

  # Event subscriber to add Omnipedia element validation to wiki node edit form.
  omnipedia_content.form_wiki_node_element_validate_event_subscriber:
    class: Drupal\omnipedia_content\EventSubscriber\Form\WikiNodeElementValidateEventSubscriber
    arguments:
      - '@plugin.manager.omnipedia_element'
      - '@renderer'
    tags:
      - { name: 'event_subscriber' }

  # OmnipediaElement hook_theme() event subscriber.
  omnipedia_content.theme_omnipedia_element_event_subscriber:
    class: Drupal\omnipedia_content\EventSubscriber\Theme\ThemeOmnipediaElementEventSubscriber
    arguments:
      - '@module_handler'
      - '@plugin.manager.omnipedia_element'
    tags:
      - { name: 'event_subscriber' }

  # hook_views_data() event subscriber to define Omnipedia date plug-ins.
  omnipedia_content.views_data_omnipedia_date_event_subscriber:
    class: Drupal\omnipedia_content\EventSubscriber\Views\ViewsDataOmnipediaDateEventSubscriber
    arguments:
      - '@string_translation'
    tags:
      - { name: 'event_subscriber' }
